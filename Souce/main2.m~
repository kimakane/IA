clc
close all
clear

disp    = @(x)imagesc(reshape(x,28,28)');
sigmoid = @(x) 1./(1+exp(-x));
% softmax = @(x) exp(x)./repmat(sum(exp(x)),size(x,1),1);
softmax = @(x) exp(x)./sum(exp(x));
model   = @(x,theta) softmax(theta'*x);

load('trainingSet.mat');

[n,m] = size(training_feature);
k = 10;
alpha = 0.00001;

%% training
theta = randn(n,k-1)*0.001;
for ii = 1:10
    for i = 1:m-1
        x = training_feature(:,i);
        y = zeros(k-1,1);
        if training_target(i)~=0
            y(training_target(i)) = 1;
        end
        h_x =  model(x,theta);
        gradi = alpha*grad(x,h_x,y);
        theta = theta -gradi ;
        if (mod(i,500)==0)
            y
        end
    end
    
end
